<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>
      Pomelo
    </title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta http-equiv="content-style-type" content="text/css" />
    <meta http-equiv="content-scripte-type" content="text/javascript" />
    <meta name="author" content="netease" />
    <meta name="version" content="1.0" />
    <meta name="keywords" content="pomelo" />
    <link type="text/css" rel="stylesheet" href="css/base.css" />
    <script src="js/lib/jquery-1.8.0.min.js" type="text/javascript">
    </script>
    <script src="js/lib/build/build.js" type="text/javascript"></script>
    <script type="text/javascript">
      require('boot');
    </script>
    <script src="js/client.js">

    </script>

      <script type="text/javascript">
      var pomelo = window.pomelo;
      var host = "172.16.9.65";
      var port = "3010";

      function entry() {
        var fromUserId = $("#uid").attr("value");
        pomelo.init({
          host: host,
          port: port,
          log: true
        }, function() {
        pomelo.request("connector.entryHandler.entry", {uid: fromUserId}, function(data) {

          });
        });
        showMsg();
      }
      function sendChat() {
          var fromUserId = $("#uid").attr("value");
          var toUserId = $("#toUid").attr("value");
          var content = $("#msg").attr("value");
          pomelo.request("connector.entryHandler.sendChat", {from:fromUserId, to:toUserId, msg:{type:'txt', content:content}}, function(data) {

          });
      }
      function showMsg() {
          pomelo.on('sendChat', function(data) {
              addMessage(data.from, data.to, data.msg.content);
              $("#chatHistory").show();

          });
      }
    </script>
  </head>
  <body>
    <div class="g-doc">
      <div class="g-banner" style="border:none">
        <div class="logo">
          <div class="img"></div>
        </div>
      </div>
      <div class="g-background">
        <div class="g-content">
          Welcome to Pomelo Chats
        </div>
      </div>

      <div class="g-button">
      <tr>
          <td>
             <input id="uid" type="text" placeholder="输入用户名或用户id" />
           </td>
          <td>
              <input id="entry" type="button" value="登陆消息系统" onclick="entry()"/>
          </td>
      </tr>
      </div>

      <div class="g-button">
            <tr>
                <td>
                    消息接收人：<input id="toUid" type="text" placeholder="输入接收用户名或id" />
                </td>
            </tr>
      </div>

      <div class="g-button">
      <tr>
          <td>
             消息内容：<input id="msg" type="text" placeholder="输入消息内容" />
          </td>
          <td>
             <input id="sendChat" type="button" value="发送" onclick="sendChat()"/>
          </td>
      </tr>
      </div>

        <div id="chatHistory">
        </div>

    </div>
  </body>
</html>
